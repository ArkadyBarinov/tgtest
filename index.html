<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="MobileOptimized" content="176" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="robots" content="noindex,nofollow" />
    <title>Document</title>
    <link rel="stylesheet" href="https://unpkg.com/js-datepicker/dist/datepicker.min.css">
    <script src="https://unpkg.com/js-datepicker"></script>
    <script src="https://cdn.jsdelivr.net/npm/@easepick/bundle@1.2.0/dist/index.umd.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js?1"></script>
    <script src="/app.js"></script>
    <script>
      function setThemeClass() {
          document.documentElement.className = Telegram.WebApp.colorScheme;
      }
      Telegram.WebApp.onEvent('themeChanged', setThemeClass);
      setThemeClass();

  </script>
      <style>
        body {
            font-family: sans-serif;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #222222);
            font-size: 16px;
            margin: 0;
            padding: 0;
            color-scheme: var(--tg-color-scheme);
        }

        a {
            color: var(--tg-theme-link-color, #2678b6);
        }

        button {
            display: block;
            width: 100%;
            font-size: 14px;
            margin: 15px 0;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            background-color: var(--tg-theme-button-color, #50a8eb);
            color: var(--tg-theme-button-text-color, #ffffff);
            cursor: pointer;
        }

        button[disabled] {
            opacity: 0.6;
            cursor: auto;
            pointer-events: none;
        }
        .forma {
          display: block;
            width: 100%;
            font-size: 14px;
            margin: 15px 0;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            background-color: var(--tg-theme-button-color, #50a8eb);
            color: var(--tg-theme-button-text-color, #ffffff);
            cursor: pointer;
            /* margin-bottom: 500px; */
        }
        button.close_btn {
            /*position: fixed;*/
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
            margin: 0;
            padding: 16px 20px;
            text-transform: uppercase;
        }

        section {
            padding: 15px 15px 65px;
            text-align: center;
        }
        .confirm {
          margin-top: 200px;
        }

        p {
            margin: 40px 0 15px;
        }

        ul {
            text-align: left;
        }

        li {
            color: var(--tg-theme-hint-color, #a8a8a8);
        }



        
        textarea {
            width: 100%;
            box-sizing: border-box;
            padding: 7px;
        }
        .hint {
            font-size: .8em;
            color: var(--tg-theme-hint-color, #a8a8a8);
        }

        .ok {
            color: green;
        }

        .err {
            color: red;
        }

        #fixed_wrap {
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            transform: translateY(100vh);
        }

        .viewport_border,
        .viewport_stable_border {
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            height: var(--tg-viewport-height, 100vh);
            pointer-events: none;
        }

        .viewport_stable_border {
            height: var(--tg-viewport-stable-height, 100vh);
        }

        .viewport_border:before,
        .viewport_stable_border:before {
            content: attr(text);
            display: inline-block;
            position: absolute;
            background: gray;
            right: 0;
            top: 0;
            font-size: 7px;
            padding: 2px 4px;
            vertical-align: top;
        }

        .viewport_stable_border:before {
            background: green;
            left: 0;
            right: auto;
        }

        .viewport_border:after,
        .viewport_stable_border:after {
            content: '';
            display: block;
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            border: 2px dashed gray;
        }

        .viewport_stable_border:after {
            border-color: green;
        }
        .qs-datepicker-container {
          display:block;
          margin-top: 200px;
        }
        small {
            font-size: 12px;
        }
        .forma {
        background-color: #2678b6;
        }
        .forma:hover {
        background-color: #50a8eb;
        }
        .forma:focus {
        outline: none;
        box-shadow: 0 0 0 3px red;
        }
        .forma:active {
        background-color: rgb(9, 63, 226);
        border-color: rgb(59, 138, 242);
        color: #eee;
        }
        #datepicker {
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 12px 8px;
        gap: 8px;
        width: 250px;
        height: 48px;
        border: 2px solid #B3B3B3;
        border-radius: 8px;
        flex: none;
        order: 1;
        align-self: stretch;
        flex-grow: 0;
        }
        .typeOT {
          padding: 30px;
        }
        .input {
          padding: 30px;
          position: relative;
          display:inline-block;
          margin-top: 20px;

        }
        .iconka {
          position:absolute;
          left: 250px;
          top: 42px;
        }
         .ViborOT {
          font-weight: 700;
          margin-bottom: 20px;
        } 
        .formRadio {
          margin-right: 10px;
          padding: 10px;
        }
        .formRadio label {
          display: inline-block;
          cursor: pointer;
          padding: 0px 15px;
          line-height: 34px;
          border: 1px solid #999;
          border-radius: 6px;
          user-select: none;
        }
        
        /* Checked */
        .formRadio input[type=radio]:checked + label {
          background: #ffe0a6;
          font-weight: 900;
          font-size: 20px;
          color:#545
        }
        
        /* Hover */
        .formRadio label:hover {
          color: #666;
        }
        /* Disabled */
        .formRadio input[type=radio]:disabled + label {
          background: #efefef;
          color: #666;
        } 
        





        /* для элемента input c type="radio" */
  .put {
    position: absolute;
    z-index: -1;
    opacity: 0;
  }

  /* для элемента label связанного с .custom-radio */
  .put+label {
    display: inline-flex;
    align-items: center;
    user-select: none;
  }

  /* создание в label псевдоэлемента  before со следующими стилями */
  .put+label::before {
    content: '';
    display: inline-block;
    width: 1em;
    height: 1em;
    flex-shrink: 0;
    flex-grow: 0;
    border: 1px solid #adb5bd;
    border-radius: 50%;
    margin-right: 0.5em;
    background-repeat: no-repeat;
    background-position: center center;
    background-size: 50% 50%;
  }

  /* стили при наведении курсора на радио */
  .put:not(:disabled):not(:checked)+label:hover::before {
    border-color: #b3d7ff;
  }

  /* стили для активной радиокнопки (при нажатии на неё) */
  .put:not(:disabled):active+label::before {
    background-color: #b3d7ff;
    border-color: #b3d7ff;
  }

  /* стили для радиокнопки, находящейся в фокусе */
  .put:focus+label::before {
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
  }

  /* стили для радиокнопки, находящейся в фокусе и не находящейся в состоянии checked */
  .put:focus:not(:checked)+label::before {
    border-color: #80bdff;
  }

  /* стили для радиокнопки, находящейся в состоянии checked */
  .put:checked+label::before {
    border-color: #0b76ef;
    background-color: #0b76ef;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e");
  }

  /* стили для радиокнопки, находящейся в состоянии disabled */
  .put:disabled+label::before {
    background-color: #e9ecef;
  }
    .formRadio {
      margin-bottom: 0.4em;
      padding: 10px;
    }
    .dfdf {
      text-align: start;
    }



    /* ---- reset ---- */

/* body {
  margin: 0;
  background-color: rgb(0, 226, 15);
}

canvas {
  display: block;
  vertical-align: bottom;
}


/* ---- particles.js container ---- */

/* #particles-js {
  position: absolute;
  width: 100%;
  height: 100%;
}  */


    </style>
</head>
<body>


  <section>

    <!-- <div id="particles-js"></div> -->

    <div>
      <div class="typeOT">

            <div class="ViborOT">
                <spam>Какой тип отпуска вы хотите взять?</spam>
            </div>

        <div class="dfdf">

          <div class="formRadio">
          <input class="put" type="radio" id="O1" onclick="toggleRadio(true)" name="vacation" value="O1">
            <label class="labeLL" for="O1">Оплачиваемый</label>
          </div>

          <div class="formRadio">
          <input class="put" type="radio" id="O2" onclick="toggleRadio(true)" name="vacation" value="O2">
            <label  class="labeLL" for="O2">За свой счет</label>
            </div>

            <div class="formRadio">
          <input class="put" type="radio" id="O3" onclick="toggleRadio(true)" name="vacation" value="O3">
            <label  class="labeLL" for="O3">Другое</label>
            </div>
          </div>
        
      </div>
      <div>
        <spam class="twodate">Выберите 2 даты в календаре: дату начала и завершения отпуска</spam>
      </div>

      <div class="input"><input id="datepicker" disabled>
        <span><img class="iconka" src = "calendar.svg" alt="SVG" width="24" height="24"></span>
      </div>
      <script>
        const picker = new easepick.create({
            element: "#datepicker",
            css: [
                "https://cdn.jsdelivr.net/npm/@easepick/bundle@1.2.0/dist/index.css"
            ],
            zIndex: 10,
            lang: "ru-RU",
            format: "DD.MM.YYYY",
            calendars: 2,
            header: "Выбирайте дни в любом порядке",
            AmpPlugin: {
                dropdown: {
                    months: true,
                    years: true,
                    minYear: 2020,
                    maxYear: 2050
                },
                resetButton: true
            },
            RangePlugin: {
                delimiter: " % "
            },
            plugins: [
                "AmpPlugin",
                "RangePlugin"
            ]
        })
            </script>

      <div id="some-id" style="position: relative;"></div>
      <!-- <div>
        
      <div class="confirm">
        <fieldset>
          <legend>
        <spam>Подтверждение</spam></legend>
        <ul>
          <li><label for="number">Тип отпуска:</label></li>
          <li><label for="mail">Дата начала отпуска:</label></li>
          <li><label for="mail">Дата конца отпуска:</label></li>
        </ul>
        </fieldset>
      </div></div> -->
      <div>
        <input class="forma" type="submit" value="Отправить форму">
      </div>
    </div>

    <!-- <h1 id="greeting"></h1>

    <div id="buttons">
        <button onclick="webviewExpand();">Expand Webview</button>
        <small>(The window goes fullscreen)</small>
        <button onclick="toggleMainButton(this);">Hide Main Button</button>
        <small>(It hides/shows main button)</small>
        <button id="btnTime" onclick="sendTime(10);">Send time</button>
        <small>(The bot will recieve a message with filled <code>web_app_data</code> field)</small>
    </div>

    <h3>Init Data: </h3>
    <pre id="initData"></pre>
    <h3>Init Data (unsafe): </h3>
    <pre id="initDataUnsafe"></pre> -->
</section>

<!-- <script type="application/javascript">
    Telegram.WebApp.ready();

    const initData = Telegram.WebApp.initData || '';
    const initDataUnsafe = Telegram.WebApp.initDataUnsafe || {};

    document.querySelector('#greeting').innerHTML = `Hi, ${initDataUnsafe.user.first_name}!`;
    document.querySelector('#initData').innerHTML = JSON.stringify(initData, null, 2);
    document.querySelector('#initDataUnsafe').innerHTML = JSON.stringify(initDataUnsafe, null, 2);
    document.querySelector('#themeData').html(JSON.stringify(Telegram.WebApp.themeParams, null, 2));

    Telegram.WebApp.MainButton
        .setText('CLOSE WEBVIEW')
        .show()
        .onClick(function(){ webviewClose(); });

    Telegram.WebApp.onEvent('themeChanged', function() {
        document.querySelector('#themeData').innerHTML = JSON.stringify(Telegram.WebApp.themeParams, null, 2);
    });

    function toggleMainButton(el) {
        const mainButton = Telegram.WebApp.MainButton;
        if (mainButton.isVisible) {
            mainButton.hide();
            el.innerHTML = 'Show Main Button';
        } else {
            mainButton.show();
            el.innerHTML = 'Hide Main Button';
        }
    }

    function webviewExpand() {
        Telegram.WebApp.expand();
    }

    function webviewClose() {
        Telegram.WebApp.close();
    }
</script> -->
<script>
const logichata = {
  id:1,
  type:2,
  dates:"232432"
};

fetch("/api.v3.change-user-otpusk", {
  method:"PUT",
  body: JSON.parse({ data })
})

  .then(res => res.json())
  .then(json => {
    console.log(json);
  })

</script>
<script>

import express, { query } from 'express'
import { PORT, TOKEN } from './config.js'
import Telegraf from 'telegraf'
import session from 'telegraf/session.js'
import { getMainMenu, NumberMenu, yesNoKeyboard, NumberCall } from './keyboards.js'
import { getRandomIntInclusive } from './db.js'
import Calendar from 'telegraf-calendar-telegram'
const app = express()
const bot = new Telegraf(TOKEN)
// instantiate the calendar
const date = new Date()
date.setDate(date.getDate() + 14);
var onlidate=[]
const calendar = new Calendar(bot,{
    minDate: date,
    startWeekDay: 1,
    weekDayNames: ["П", "В", "С", "Ч", "П", "С", "В"],
    monthNames: [
        "Январь", "Февраль", "Март", "Апрель", "Май", "Июнь",
        "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"
    ],
})

bot.use(session())


bot.start(ctx => {
    ctx.replyWithHTML(
        `Приветсвуем вас <b>${ctx.message.from.first_name}</b> в лучшей команде. Данный бот поможет вам <b>сменить дату отпуска</b>\n\n`+
        `Чтобы мы могли легко вас найти в нашей базе данных, пожалуйста поделись вашим телефоном`,
        NumberMenu())
})
// bot.delete_message(message.chat.id, message.message_id)
// bot.deleteMessage(msg.chat.id, messageId)

// bot.on('message', function (msg) {//при получении сообщения
//     var text=msg.text;//получаем текст сообщения
//     if( text.indexOf('СЛОВО') >= 0){//проверяем на наличие слова
//         var chatId = msg.chat.id;//получаем ChatId группы
//         var msgId = msg.message_id;//получаем Id сообщения
//         bot.deleteMessage(chatId,msgId);//удаляем сообщение
//     }
// });


//   bot.hears("Мне повезет", (ctx) => {
//      kolvod = getRandomIntInclusive()
//   })


bot.hears('Отмена', async ctx => {
    ctx.replyWithHTML(
        `<b>Этот бот создан для сотрудников кампании Sokolov:</b>\nЧтобы мы могли быть уверены что вы <b>${ctx.message.from.first_name} ${ctx.message.from.last_name}</b> сотрудник этой кампании , поделитесь номером телефона\n`
    )
})
bot.hears('Поделиться номером телефона', async ctx => {
    ctx.reply('Вы точно хотите слить ваши данные в сеть?', { reply_markup: { keyboard: [[{text: '📲 поделиться номером', request_contact: true}]], force_reply: true } })

    bot.on("contact", (data) => {
        console.log(data.message.chat.id);
        ctx.replyWithHTML(
            '<b>Спасибо за доверие:</b>\nОжидайте пока мы проверим вас по базе данных\n',
            getMainMenu()
        )
    })
})


bot.hears('Узнать дату отпуска', async ctx => {
    ctx.replyWithHTML(
        '<b>Ваш отпуск состоится:</b>\nВ базе отсутствуют данные о вашем отпуске,немного подождите, если проблема осталась, то обратитесь к вашему руководству\n'
    )
})
/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////


bot.hears('Сменить дату отпуска', async ctx => {
    try {
        ctx.replyWithHTML(
        'Воспользуйтесь данным календарем, чтобы выбрать <b>день начала</b> вашего отпуска',
    )
    await ctx.reply("Просто выберите день начала вашего отпуска", calendar.getCalendar());

    calendar.setDateListener((context, date) => {
        // context.reply(date)
        onlidate=date.split('T')
        console.log(date.split(','));
        ctx.replyWithHTML('<b>А теперь:</b>\n Укажите продолжительность отпуска в днях:\n', NumberCall())
    })
    await bot.on('text', ctx => {

    console.log(date),
    console.log(ctx),
    ctx.replyWithHTML(
        `Я, <b>${ctx.message.from.first_name} ${ctx.message.from.last_name}</b>, подтвеждаю смену даты отпуска на начало ${onlidate} и с продолжительностью ${ctx.message.text} день(дня((дней)):\n\n`+
        `<b>(отправить документ на подписание)</b>`,yesNoKeyboard())
})

    } catch (error) {
        console.error(error)
        
    }
})

bot.action("yes", (ctx) => {
    ctx.reply('Ваше заявление по смене дат отпуска успешно получено и в данный момент находится на рассмотрении',getMainMenu(),ctx.deleteMessage())
})

bot.action("no", (ctx) => {
    ctx.reply('Все осталось как прежде',getMainMenu(),ctx.deleteMessage())
    
})

/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////


bot.hears('Смотивируй меня на работу без отпуска', ctx => {
    ctx.replyWithPhoto(
        'https://img2.goodfon.ru/wallpaper/nbig/7/ec/justdoit-dzhastduit-motivaciya.jpg',
        {
            caption: 'Не вздумай сдаваться!'
        }
    )
})


//  bot.action("Мне повезет", (ctx) => {
//     kolvod = getRandomIntInclusive()
//  })



// bot.hears("Мне повезет", (ctx) => {
//     return ctx.getRandomIntInclusive
//  } );
// ;


bot.hears("Хочу уменьшить свой уровень стресса", (ctx) => {
    return ctx.replyWithAudio({ source: "./song.mp3" },
    {
        caption:'Успокойтесь и снова за работу'
    }
    );
  });
  bot.hears("Зачем", (ctx) => {
    return ctx.replyWithVideo({ source: "./s1.gif" },
    {
        caption:' '
    }
    );
  });

// bot.action(['yes', 'no', 'change your choice'], ctx => {
//     if (ctx.callbackQuery.data === 'yes') {
//         addTask(ctx.session.taskText)
//         ctx.editMessageText('Ваша заявка на смену отпуска успешно отправлена, ожидайте')
//     } else {
//         ctx.deleteMessage()
//     }
// })





// bot.help((ctx) => ctx.reply('Send me a sticker'));
bot.help(ctx => {ctx.reply("Да, чем я могу помочь");})
bot.on('sticker', (ctx) => ctx.reply('👍'));
bot.hears('привет', (ctx) => ctx.reply(`привет ${ctx.message.from.first_name} ${ctx.message.from.last_name}`));
bot.hears('что ты можешь?', (ctx) => ctx.reply('я могу все'));
bot.on('photo', (ctx) => ctx.reply('Вы зачем то прислали это изображение, хотя я не просил этого'));
bot.hears('узнать отпуск', (ctx) => ctx.reply('без проблем'));
bot.on('edited_message', ctx => {
    ctx.reply('Вы успешно изменили сообщение')
})
bot.on('voice', ctx => {
    ctx.reply('Какой чудный голос')
})
bot.command('time', ctx => {
    ctx.reply(String(new Date()))
})
bot.command("whoami", (ctx) => {
    const { id, username, first_name, last_name } = ctx.from;
    return ctx.replyWithMarkdown(`Кто ты в телеграмме:
  *id* : ${id}
  *username* : ${username}
  *Имя* : ${first_name}
  *Фамилия* : ${last_name}
  *chatId* : ${ctx.chat.id}`);
  });
bot.launch()
app.listen(PORT, () => console.log(`My server is running on port ${PORT}`))

</script>
<!-- <script>
  import express, { query } from 'express'
  import Telegraf from 'telegraf'
  const app = express()
  bot.use(session())


bot.start(ctx => {
    ctx.replyWithHTML(
        'Приветсвуем вас в лучшей команде. Данный бот поможет вам <b>сменить дату отпуска</b>\n\n'+
        'Чтобы мы могли легко вас найти в нашей базе данных, пожалуйста поделись вашим телефоном',
        )
})

bot.launch()
</script> -->
})
  <script>
    
    function toggleRadio(flag){
      if(!flag) {
        document.getElementById('datepicker').setAttribute("disabled", "true");
      } else {
        document.getElementById('datepicker').removeAttribute("disabled");
        document.getElementById('datepicker').focus();
      }
      
    }

  </script>

<!-- <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script> -->

<!-- <script>

particlesJS("particles-js", {
  "particles": {
    "number": {
      "value": 355,
      "density": {
        "enable": true,
        "value_area": 789.1476416322727
      }
    },
    "color": {
      "value": "#000000"
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      },
      "image": {
        "src": "img/github.svg",
        "width": 100,
        "height": 100
      }
    },
    "opacity": {
      "value": 0.48927153781200905,
      "random": false,
      "anim": {
        "enable": true,
        "speed": 0.2,
        "opacity_min": 0,
        "sync": false
      }
    },
    "size": {
      "value": 2,
      "random": true,
      "anim": {
        "enable": true,
        "speed": 2,
        "size_min": 0,
        "sync": false
      }
    },
    "line_linked": {
      "enable": false,
      "distance": 150,
      "color": "#ffffff",
      "opacity": 0.4,
      "width": 1
    },
    "move": {
      "enable": true,
      "speed": 2.2,
      "direction": "none",
      "random": true,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  }, -->
  <!-- // "interactivity": {
  //   "detect_on": "canvas",
  //   "events": {
  //     "onhover": {
  //       "enable": true,
  //       "mode": "bubble"
  //     },
  //     "onclick": {
  //       "enable": true,
  //       "mode": "push"
  //     },
  //     "resize": true
  //   },
  //   "modes": {
  //     "grab": {
  //       "distance": 400,
  //       "line_linked": {
  //         "opacity": 1
  //       }
  //     },
  //     "bubble": {
  //       "distance": 83.91608391608392,
  //       "size": 1,
  //       "duration": 3,
  //       "opacity": 1,
  //       "speed": 3
  //     },
  //     "repulse": {
  //       "distance": 200,
  //       "duration": 0.4
  //     },
  //     "push": {
  //       "particles_nb": 4
  //     },
  //     "remove": {
  //       "particles_nb": 2
  //     }
  //   }
  // },
//   "retina_detect": true
// });
// </script> -->